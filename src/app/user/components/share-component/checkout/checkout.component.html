<div class="breakcrum">
    <a [routerLink]="['']">
        <div class="home"><i class="fa fa-home" aria-hidden="true"></i></div>
    </a>
    >
    <div class="lv1">Checkout</div>
</div>
<div class="wrap">
    <app-loader *ngIf="isLoading"></app-loader>
    <div class="section">
        <div class="prod">
            <div class="diachi" *ngIf="!isEditing && !isAdding">
                <div class="text">
                    <div class="titleDiv">
                        <div class="title">Address</div>
                    </div>
                    <div class="addDIV" (click)="onChooseAddress(index)"
                        *ngFor="let address of addresses.data, let index = index"
                        [ngStyle]="{'border': chooseAdd==index ? '2px solid blue' : '2px solid rgb(177, 177, 177)'}">
                        <div class="edit">
                            <span class="editBtn" (click)="onChooseEdit(address)">Edit address</span>
                            <span class="default" *ngIf="address.isDefault">Default</span>
                        </div>
                        <div class="ten">{{address.fullName}}</div>
                        <div class="sdt">{{address.phone}}</div>
                        <div class="position">{{address.fullAddress}}</div>
                    </div>
                </div>
                <div class="btn">
                    <div class="add" (click)="onChooseAdd()">
                        Add address
                    </div>
                </div>
            </div>
            <div class="formDiv" *ngIf="isEditing">
                <div class="title">User Address</div>
                <form>
                    <div class="inputDiv">
                        <div class="name">Full name</div>
                        <input type="text" name="full" [ngModel]="chooseAddress.fullName"
                            (ngModelChange)="chooseAddress.fullName=$event">
                    </div>
                    <div class="inputDiv">
                        <div class="name">Phone</div>
                        <input type="text" name="phone" [ngModel]="chooseAddress.phone"
                            (ngModelChange)="chooseAddress.phone=$event">
                    </div>
                    <div class="inputDiv">
                        <div class="name">Country</div>
                        <input type="text" name="country" [ngModel]="chooseAddress.country"
                            (ngModelChange)="chooseAddress.country=$event">
                    </div>
                    <div class="inputDiv">
                        <div class="name">City</div>
                        <select name="city" [ngModel]="chooseAddress.city" (ngModelChange)="chooseAddress.city=$event">
                            <option value="Hanoi City">Hanoi City</option>
                            <option value="Haiphong City">Haiphong City</option>
                            <option value="Danang City">Danang City</option>
                            <option value="HCM City">HCM City</option>
                            <option value="Cantho City">Cantho City</option>
                        </select>
                    </div>
                    <div class="inputDiv">
                        <div class="name">District</div>
                        <select name="district" [ngModel]="chooseAddress.district"
                            (ngModelChange)="chooseAddress.district=$event">
                            <option value="1 District">1 District</option>
                            <option value="2 District">2 District</option>
                            <option value="3 District">3 District</option>
                            <option value="4 District">4 District</option>
                            <option value="5 District">5 District</option>
                        </select>
                    </div>
                    <div class="inputDiv">
                        <div class="name">Ward</div>
                        <select name="ward" [ngModel]="chooseAddress.ward" (ngModelChange)="chooseAddress.ward=$event">
                            <option value="1 Ward">1 Ward</option>
                            <option value="2 Ward">2 Ward</option>
                            <option value="3 Ward">3 Ward</option>
                            <option value="4 Ward">4 Ward</option>
                            <option value="5 Ward">5 Ward</option>
                        </select>
                    </div>
                    <div class="inputDiv">
                        <div class="name">Address</div>
                        <input type="text" name="address" [ngModel]="chooseAddress.address"
                            (ngModelChange)="chooseAddress.address=$event">
                    </div>
                    <div class="checkbox">
                        <input type="checkbox" name="default" [ngModel]="chooseAddress.isDefault"
                            (ngModelChange)="chooseAddress.isDefault=$event">
                        <span class="text">Default</span>
                    </div>
                    <button class="btn update" (click)="onUpdate()">Update</button>
                    <button class="btn cancel" (click)="onCancelEdit()">Cancel</button>
                </form>
            </div>
            <div class="formDiv" *ngIf="isAdding">
                <div class="title">User Address</div>
                <form>
                    <div class="inputDiv">
                        <div class="name">Full name</div>
                        <input type="text" name="full" [ngModel]="chooseAddress.fullName"
                            (ngModelChange)="chooseAddress.fullName=$event">
                    </div>
                    <div class="inputDiv">
                        <div class="name">Phone</div>
                        <input type="text" name="phone" [ngModel]="chooseAddress.phone"
                            (ngModelChange)="chooseAddress.phone=$event">
                    </div>
                    <div class="inputDiv">
                        <div class="name">Country</div>
                        <input type="text" name="country" [ngModel]="chooseAddress.country"
                            (ngModelChange)="chooseAddress.country=$event">
                    </div>
                    <div class="inputDiv">
                        <div class="name">City</div>
                        <select name="city" [ngModel]="chooseAddress.city" (ngModelChange)="chooseAddress.city=$event">
                            <option value="Hanoi City">Hanoi City</option>
                            <option value="Haiphong City">Haiphong City</option>
                            <option value="Danang City">Danang City</option>
                            <option value="HCM City">HCM City</option>
                            <option value="Cantho City">Cantho City</option>
                        </select>
                    </div>
                    <div class="inputDiv">
                        <div class="name">District</div>
                        <select name="district" [ngModel]="chooseAddress.district"
                            (ngModelChange)="chooseAddress.district=$event">
                            <option value="1 District">1 District</option>
                            <option value="2 District">2 District</option>
                            <option value="3 District">3 District</option>
                            <option value="4 District">4 District</option>
                            <option value="5 District">5 District</option>
                        </select>
                    </div>
                    <div class="inputDiv">
                        <div class="name">Ward</div>
                        <select name="ward" [ngModel]="chooseAddress.ward" (ngModelChange)="chooseAddress.ward=$event">
                            <option value="1 Ward">1 Ward</option>
                            <option value="2 Ward">2 Ward</option>
                            <option value="3 Ward">3 Ward</option>
                            <option value="4 Ward">4 Ward</option>
                            <option value="5 Ward">5 Ward</option>
                        </select>
                    </div>
                    <div class="inputDiv">
                        <div class="name">Address</div>
                        <input type="text" name="address" [ngModel]="chooseAddress.address"
                            (ngModelChange)="chooseAddress.address=$event">
                    </div>
                    <div class="checkbox">
                        <input type="checkbox" name="default" [ngModel]="chooseAddress.isDefault"
                            (ngModelChange)="chooseAddress.isDefault=$event">
                        <span class="text">Default</span>
                    </div>
                    <button class="btn update" (click)="onAdd()">Add</button>
                    <button class="btn cancel" (click)="onCancelAdd()">Cancel</button>
                </form>
            </div>
            <div class="phuongthuc">
                <div class="title">Payment Method</div>
                <div class="methodDiv" *ngFor="let pm of listPM.data, let index = index">
                    <div class="method" (click)="onChoosePM(index)"
                    [ngStyle]="{'border': choosePM==index ? '2px solid blue' : '2px solid black' }">
                        <div class="remove" (click)="onRemove(pm.id)">Remove</div>
                        <div class="brand" [ngStyle]="{'color': choosePM==index ? 'blue' : 'black' }">
                            {{pm.card.brand}}</div>
                        <div class="brand" [ngStyle]="{'color': choosePM==index ? 'blue' : 'black' }">
                            {{pm.billing_details.name}}</div>
                        <div class="id" [ngStyle]="{'color': choosePM==index ? 'blue' : 'black' }">**** **** ****
                            {{pm.card.last4}}</div>
                        <div class="exp" [ngStyle]="{'color': choosePM==index ? 'blue' : 'black' }">
                            {{pm.card.exp_month}} {{pm.card.exp_year}}</div>
                    </div>
                </div>
                <div class="btn" (click)="onChooseAddPM()">Add payment method</div>
            </div>
            <div class="addPMDiv" *ngIf="isChooseAddPM">
                <app-stripe></app-stripe>
                <div class="btn" (click)="onFinishAddPM()">Finish</div>
            </div>
        </div>
        <div class="policy">
            <div class="thongtin">
                <div class="title">
                    <div class="text">Order Info</div>
                    <a [routerLink]="'/user/cart'" class="edit">Edit</a>
                </div>
                <div class="product" *ngFor="let prod of chooseCart, let index = index">
                    <div class="left">
                        <div class="imgDiv">
                            <img [src]="prod.data.image" class="img">
                        </div>
                    </div>
                    <div class="right">
                        <div class="name">{{prod.data.name}}</div>
                        <div class="qua">Quantity: {{chooseValue[index]}}</div>
                        <div class="price">AUD {{prod.data.price}}</div>
                    </div>
                </div>
            </div>
            <div class="thanhtoan">
                <div class="div">
                    <div class="title2">Pay</div>
                    <div class="content">
                        <span class="text">Provisional</span><span class="price">AUD {{provisPrice}}</span>
                    </div>
                    <div class="content">
                        <span class="text">Delivery fee</span><span class="deli">AUD {{deliPrice}}</span>
                    </div>
                    <div class="content">
                        <span class="text">Discount</span><span class="promo">AUD {{discountPrice}}</span>
                    </div>
                    <div class="content">
                        <span class="text">Into money</span><span class="redprice">AUD {{totalPrice}}</span>
                    </div>
                    <div class="vat">(VAT included)</div>
                    <div class="pay" (click)="onPay()">PAY</div>
                </div>
            </div>
        </div>
    </div>
</div>